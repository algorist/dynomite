<html>
  <head>
    <script type="text/javascript" src="/javascripts/jquery-1.2.6.js"></script>
    <script type="text/javascript" src="/javascripts/domec.js"></script>
    <script type="text/javascript">
      $(document).ready(function(data) {
        $.getJSON("/rpc/info/stats", function(stats) {
          $("#node").text(stats.node);
          $.each(stats.running_nodes, function(n, node) {
            $.create("li", {}, node).appendTo("#running_nodes");
          });
          $.each(stats.member_nodes, function(n, node_struct) {
            var node = node_struct[0];
            var partitions = node_struct[1];
						$.create("a", {'href' : '#'}, "+").click(function() {
							$("#" + node.split("@").join("at") + "_partitions").toggle("slow");
						}).appendTo($.create("li", {}, node + " ").appendTo("#member_nodes"));
            var children = $.map(partitions, function(part) {
              return $.create("li", {}, "" + part);
            });
            $.create("ul", {'id' : node.split("@").join("at") + "_partitions", 'style' : 'display: none;'}, children).appendTo('#member_nodes');
          });
        });
      });
    </script>
  </head>
  <body>
    <h1>Dynomite</h1>
    <h2>Dashboard for <span id="node"></span></h2>
    <h3>Cluster Stats</h3>
    <ul>
      <li>Running Nodes:</li><ul id="running_nodes"></ul>
      <li>Member Nodes:</li><ul id="member_nodes"></ul>
    </ul>
  </body>
</html>